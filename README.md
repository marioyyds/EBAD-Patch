# Ensemble-based Blackbox Attacks on Dense Prediction

This repo is referred to the [paper](https://arxiv.org/abs/2303.14304) and [code](https://github.com/CSIPlab/EBAD). And compared with original code, it has upgrade the mmdetection version to ***v3.3.0***, which means it will support more models to attack.

## Attack multiple blackbox models (detection and segmentation) using a single perturbation.

Below we generate perturbation to map the Bicycle on the right-hand-side to Train (top), and map the Car in the middle to Traffic Light (bottom). More details are in the [paper](https://arxiv.org/abs/2303.14304).

<center>
<img src="doc/fig-joint-example1.png" alt= “joint-attack1” width="800">

<img src="doc/fig-joint-example2.png" alt= “joint-attack2” width="800">

<img src="doc/fig-joint-legends.png" alt= “seg-labels” width="800">
</center>

## Attack blackbox video object detection. 
Below we generate attacks on video frames to vanish the Jets (top), and perturb Cars to Cows (bottom). Videos are generated by perturbing each frames with EBAD and passing through the victim model. Same setting as N=5 in Table 2 for attacking RetinaNet as the blackbox victim model.

Click on the images to play videos.
<center>
<a href="https://player.vimeo.com/video/811461221?h=3e0765a066&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479"> <img src="doc/frame-jets.png" width="800"></a>

<a href="https://player.vimeo.com/video/811461200?h=b2a3a41f62&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479"> <img src="doc/frame-cars.png" width="800"></a>
</center>


## Environment

* python==3.8
* [mmdetection v3.3.0](https://github.com/open-mmlab/mmdetection/tree/v3.3.0)
* pip install -r requirements.txt


## Datasets

Object detection: get VOC and COCO datasets under `/data` folder.

```shell
cd data
bash get_voc.sh
bash get_coco.sh
```

## Perform attacks

### Object detection

1. Download and place `mmdetection` folder under EBAD directory.

2. run ```python mmdet_model_info.py``` to download pre-trained models from MMCV.

3. run ```python attack_bb_det.py``` to perform attacks on object detection.

## Acknowledgement

We thank the models support from [MMCV](https://github.com/open-mmlab/mmcv).   
```shell
@InProceedings{Cai_2023_CVPR,
    author    = {Cai, Zikui and Tan, Yaoteng and Asif, M. Salman},
    title     = {Ensemble-Based Blackbox Attacks on Dense Prediction},
    booktitle = {Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)},
    month     = {June},
    year      = {2023},
    pages     = {4045-4055}
}
```